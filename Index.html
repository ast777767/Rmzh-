<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Qyzgylt Taspa ‚Äî –ú–∞–º–º–æ–≥—Ä–∞—Ñ–∏—è –≤ –ê—Å—Ç–∞–Ω–µ</title>
<meta name="description" content="Qyzgylt Taspa: –∫–∞—Ä—Ç–∞ –∫–ª–∏–Ω–∏–∫ –º–∞–º–º–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –ê—Å—Ç–∞–Ω–µ, —Å–∞–º–æ–æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, —Å—Ç–∞—Ç—å–∏. –î–µ–º–æ-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è GitHub Pages." />

<!-- Leaflet (–∫–∞—Ä—Ç–∞) -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
  crossorigin=""
/>
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
></script>

<style>
  :root{
    /* —Ä–æ–∑–æ–≤–∞—è —Ç–µ–º–∞ */
    --bg:#fff6fb;
    --card:#ffffff;
    --ink:#1f2430;
    --muted:#6a7280;
    --border:#ffd7ea;
    --accent:#ff4fa3;     /* –≥–ª–∞–≤–Ω—ã–π —Ä–æ–∑–æ–≤—ã–π */
    --accent-2:#845ef7;   /* —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
    --good:#18a999;
    --warn:#ff9800;
    --danger:#e03b5a;
    --soft:#ffe3f1;
    --radius:16px;
    --pad:16px;
    --shadow:0 10px 26px rgba(255,79,163,.17);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Roboto,Arial,sans-serif;
    -webkit-font-smoothing:antialiased; line-height:1.45;
  }
  a{color:var(--accent); text-decoration:none}
  a:hover{text-decoration:underline}

  header{
    position:sticky; top:0; z-index:50;
    background:rgba(255,246,251,.75);
    backdrop-filter:saturate(180%) blur(10px);
    border-bottom:1px solid var(--border);
  }
  .wrap{max-width:1100px; margin:0 auto; padding:0 14px}
  .topbar{display:flex; align-items:center; gap:12px; padding:12px 0}
  .brand{font-weight:800; letter-spacing:.3px}
  .brand .ribbon{display:inline-block; background:var(--accent); color:#fff; padding:2px 10px; border-radius:999px; margin-left:6px; font-size:12px}
  nav{margin-left:auto; display:flex; gap:8px; flex-wrap:wrap}
  nav a{
    display:inline-flex; align-items:center; gap:6px;
    padding:8px 12px; border-radius:12px;
    border:1px solid transparent; color:var(--ink); text-decoration:none;
  }
  nav a.active{background:#fff; border-color:var(--border); box-shadow:var(--shadow)}

  main{padding:20px 0 88px}
  .grid{display:grid; gap:16px}
  @media(min-width:960px){ .grid-2{grid-template-columns:1.2fr .8fr} .grid-3{grid-template-columns:repeat(3,1fr)} }

  .card{
    background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
    padding:var(--pad); box-shadow:var(--shadow);
  }
  h1,h2,h3{margin:.2em 0 .6em}
  .muted{color:var(--muted)}
  .pill{display:inline-block; padding:6px 10px; border-radius:999px; background:var(--soft); font-size:12px}
  .chip{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:#fff; font-size:13px}

  label{display:block; font-size:13px; color:var(--muted); margin-bottom:6px}
  input[type="text"], input[type="number"], input[type="date"], select, textarea{
    width:100%; padding:12px; border:1px solid var(--border); border-radius:12px; background:#fff; font-size:16px;
  }

  .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
  .btn{
    display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px;
    border:1px solid var(--border); background:#fff; cursor:pointer; text-decoration:none; color:var(--ink);
  }
  .btn.primary{background:var(--accent); color:#fff; border-color:transparent}
  .btn.safe{background:var(--good); color:#fff; border-color:transparent}
  .btn.warn{background:var(--warn); color:#fff; border-color:transparent}
  .btn.danger{background:var(--danger); color:#fff; border-color:transparent}

  .list{display:grid; gap:12px}
  .item{
    padding:12px; border:1px solid var(--border); border-radius:12px; background:#fff;
  }
  .item .t{font-weight:700}
  .item .s{color:var(--muted); font-size:14px}
  .item .tag{font-size:12px; background:#fff; border:1px solid var(--border); border-radius:999px; padding:2px 8px}

  footer{
    position:fixed; bottom:0; left:0; right:0; background:#fff; border-top:1px solid var(--border); z-index:60;
  }
  .tabs{max-width:1100px; margin:0 auto; display:grid; grid-template-columns:repeat(6,1fr)}
  .tab{padding:12px; text-align:center; color:var(--ink); text-decoration:none; font-size:14px}
  .tab.active{background:var(--bg); font-weight:700}

  .share-url{word-break:break-all; font-size:13px; color:var(--muted)}
  .hint{font-size:13px; color:var(--muted)}
  .hidden{display:none !important}

  /* –∫–∞—Ä—Ç–∞ */
  #map{width:100%; height:420px; border-radius:14px; border:1px solid var(--border)}
  .map-toolbar{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:8px}
  .form-inline input, .form-inline select{min-width:160px}
</style>
</head>
<body>
<header>
  <div class="wrap topbar">
    <div class="brand">Qyzgylt Taspa <span class="ribbon">üéÄ</span></div>
    <nav>
      <a href="#/home"    data-view="home">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="#/clinics" data-view="clinics">–ö–∞—Ä—Ç–∞ –∫–ª–∏–Ω–∏–∫</a>
      <a href="#/media"   data-view="media">–í–∏–¥–µ–æ/–°—Ç–∞—Ç—å–∏</a>
      <a href="#/about"   data-view="about">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
    </nav>
  </div>
</header>

<main class="wrap">
  <!-- HOME -->
  <section id="view-home" class="grid grid-2">
    <div class="card">
      <h1>–ú–∞–º–º–æ–≥—Ä–∞—Ñ–∏—è –≤ –ê—Å—Ç–∞–Ω–µ ‚Äî –∫–∞—Ä—Ç–∞</h1>
      <p class="muted">–ö–∞—Ä—Ç–∞ –∫–ª–∏–Ω–∏–∫, –≥–¥–µ –¥–µ–ª–∞—é—Ç –º–∞–º–º–æ–≥—Ä–∞—Ñ–∏—é; –ø–µ—Ä–µ—Ö–æ–¥—ã –Ω–∞ –≤–∏–¥–µ–æ –ø–æ —Å–∞–º–æ–æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é –∏ –ø–æ–¥–±–æ—Ä–∫–∞ —Å—Ç–∞—Ç–µ–π. –í—Å—ë –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî –º–æ–∂–Ω–æ –∑–∞–ª–∏—Ç—å –Ω–∞ GitHub Pages, –∏ –ª—é–±–æ–π —Å–º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å –ø–æ —Å—Å—ã–ª–∫–µ.</p>
      <div class="row" style="margin-top:8px">
        <a class="btn primary" href="#/clinics">üè• –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É</a>
        <a class="btn" href="#/media">üì∫ –í–∏–¥–µ–æ –∏ —Å—Ç–∞—Ç—å–∏</a>
      </div>
      <p class="hint">‚ö†Ô∏è –ü—Ä–æ—Ç–æ—Ç–∏–ø –¥–ª—è –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ó–∞ —Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –ø–æ–∫–∞–∑–∞–Ω–∏—è–º–∏ ‚Äî –∫ –≤—Ä–∞—á—É.</p>
    </div>
    <div class="card">
      <h2>–ë—ã—Å—Ç—Ä—ã–µ —Å–æ–≤–µ—Ç—ã</h2>
      <div class="list">
        <div class="chip">üë© 40+ ‚Äî –æ–±—Å—É–¥–∏ —Å–∫—Ä–∏–Ω–∏–Ω–≥ —Å –≤—Ä–∞—á–æ–º</div>
        <div class="chip">üóì –°–∞–º–æ–æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ ‚Äî —Ä–∞–∑ –≤ –º–µ—Å—è—Ü</div>
        <div class="chip">üèÉ‚Äç‚ôÄÔ∏è –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Å–∞</div>
        <div class="chip">üö´ –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∞–ª–∫–æ–≥–æ–ª—å/–∫—É—Ä–µ–Ω–∏–µ</div>
      </div>
    </div>
  </section>

  <!-- CLINICS + MAP -->
  <section id="view-clinics" class="grid grid-2 hidden">
    <div class="card">
      <div class="map-toolbar">
        <div class="form-inline row">
          <input id="q" type="text" placeholder="–ü–æ–∏—Å–∫: –∫–ª–∏–Ω–∏–∫–∞/–∞–¥—Ä–µ—Å‚Ä¶" />
          <select id="filter-tag">
            <option value="">–í—Å–µ</option>
            <option value="–≥–æ—Å">–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ</option>
            <option value="—á–∞—Å—Ç–Ω–∞—è">–ß–∞—Å—Ç–Ω—ã–µ</option>
          </select>
          <button class="btn" id="btn-find">–ù–∞–π—Ç–∏</button>
          <button class="btn" id="btn-reset">–°–±—Ä–æ—Å</button>
        </div>
        <div class="row" style="margin-left:auto">
          <button class="btn safe" id="btn-add">+ –ö–ª–∏–Ω–∏–∫–∞</button>
        </div>
      </div>
      <div id="map"></div>
      <p class="hint" style="margin-top:8px">‚åö –ù—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞–π–ª–æ–≤ –∫–∞—Ä—Ç—ã. –ú–∞—Ä–∫–µ—Ä—ã –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã: –µ—Å—Ç—å –∞–¥—Ä–µ—Å –∏ ¬´–ú–∞—Ä—à—Ä—É—Ç¬ª (Google Maps).</p>
    </div>
    <div class="card">
      <h2>–°–ø–∏—Å–æ–∫ –∫–ª–∏–Ω–∏–∫</h2>
      <div id="clinics-list" class="list"></div>
    </div>
  </section>

  <!-- MEDIA -->
  <section id="view-media" class="grid grid-2 hidden">
    <div class="card">
      <h2>üé• –°–∞–º–æ–æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (YouTube)</h2>
      <div class="row" style="margin-bottom:10px">
        <a class="btn primary" target="_blank" rel="noopener"
           href="https://www.youtube.com/results?search_query=%D1%81%D0%B0%D0%BC%D0%BE%D0%BE%D0%B1%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5+%D0%B3%D1%80%D1%83%D0%B4%D0%B8">
          üîó –û—Ç–∫—Ä—ã—Ç—å –ø–æ–¥–±–æ—Ä–∫—É –Ω–∞ YouTube
        </a>
      </div>
      <!-- –ü—Ä–∏–º–µ—Ä –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ —Ä–æ–ª–∏–∫–∞ (–º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–≤–æ–π ID) -->
      <div style="position:relative; padding-bottom:56.25%; height:0; overflow:hidden; border-radius:12px; border:1px solid var(--border)">
        <iframe
          src="https://www.youtube.com/embed/5Q5G1n3F3fM?rel=0"
          title="–°–∞–º–æ–æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≥—Ä—É–¥–∏ ‚Äî –æ–±—É—á–∞—é—â–µ–µ –≤–∏–¥–µ–æ"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen
          style="position:absolute; top:0; left:0; width:100%; height:100%; border:0"
        ></iframe>
      </div>
      <p class="hint">–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –¥—Ä—É–≥–∏–µ —Ä–æ–ª–∏–∫–∏ ‚Äî —Å–∫–∞–∂–∏ —Å—Å—ã–ª–∫–∏, –ø–æ–¥—Å—Ç–∞–≤–ª—é –∏—Ö –≤ iframe.</p>
    </div>

    <div class="card">
      <h2>üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ)</h2>
      <div id="articles-list" class="list"></div>
      <p class="hint">–°—Å—ã–ª–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ. –°–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å.</p>
    </div>
  </section>

  <!-- ABOUT -->
  <section id="view-about" class="grid hidden">
    <div class="card">
      <h2>–û –ø—Ä–æ–µ–∫—Ç–µ</h2>
      <p>Qyzgylt Taspa ‚Äî —É—á–µ–±–Ω—ã–π –ø—Ä–æ—Ç–æ—Ç–∏–ø: –∫–∞—Ä—Ç–∞ –∫–ª–∏–Ω–∏–∫ –º–∞–º–º–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –ê—Å—Ç–∞–Ω–µ, –≤–∏–¥–µ–æ –∏ —Å—Ç–∞—Ç—å–∏ –ø–æ —Ç–µ–º–µ. –ú–æ–∂–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –¥–µ–º–æ –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å.</p>
      <p class="muted">–ù–µ—Ç —Å–±–æ—Ä–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.</p>
    </div>
  </section>
</main>

<footer>
  <div class="tabs">
    <a class="tab" data-view="home"    href="#/home">üè†</a>
    <a class="tab" data-view="clinics" href="#/clinics">üó∫</a>
    <a class="tab" data-view="media"   href="#/media">üì∫</a>
    <a class="tab" data-view="about"   href="#/about">‚ÑπÔ∏è</a>
  </div>
</footer>

<script>
(function(){
  const routes = ["home","clinics","media","about"];

  function show(view){
    routes.forEach(v=>{
      const sec = document.getElementById('view-'+v);
      if(sec) sec.classList.add('hidden');
      document.querySelectorAll('[data-view="'+v+'"]').forEach(a=>a.classList.remove('active'));
    });
    const active = document.getElementById('view-'+view);
    if(active) active.classList.remove('hidden');
    document.querySelectorAll('[data-view="'+view+'"]').forEach(a=>a.classList.add('active'));
    localStorage.setItem('qt_last_view', view);
    if(view==='clinics') setTimeout(initMapIfNeeded, 0);
  }

  function parseRoute(){
    const hash = location.hash || "#/home";
    const view = (hash.split("/")[1] || "home").toLowerCase();
    if(!routes.includes(view)) return show("home");
    show(view);
  }

  window.addEventListener('hashchange', parseRoute);
  document.addEventListener('DOMContentLoaded', ()=>{
    parseRoute();
    renderArticles();
    renderClinicsList();
    attachHandlers();
  });

  /* ---------- –î–∞–Ω–Ω—ã–µ: –∫–ª–∏–Ω–∏–∫–∏ ---------- */
  // –ë–∞–∑–æ–≤—ã–π –Ω–∞–±–æ—Ä (–º–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ UI; –ø—Ä–∞–≤–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage)
  const BASE_CLINICS = [
    // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–ª—è –¥–µ–º–æ)
    { id: 1, t:'–ì–æ—Ä–æ–¥—Å–∫–∞—è –±–æ–ª—å–Ω–∏—Ü–∞ ‚Ññ2', addr:'—É–ª. –¢—É—Ä–∞—Ä–∞ –†—ã—Å–∫—É–ª–æ–≤–∞, 6', tag:'–≥–æ—Å', lat:51.1477, lng:71.4216 },
    { id: 2, t:'–ì–æ—Ä–æ–¥—Å–∫–∞—è –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞ ‚Ññ9', addr:'–ø—Ä. –ú–∞–Ω–≥–∏–ª–∏–∫ –ï–ª, 16/1', tag:'–≥–æ—Å', lat:51.0899, lng:71.4165 },
    { id: 3, t:'–ú–Ω–æ–≥–æ–ø—Ä–æ—Ñ–∏–ª—å–Ω—ã–π –º–µ–¥—Ü–µ–Ω—Ç—Ä', addr:'—É–ª. –ú–∞–Ω–∞—Å–∞, 17', tag:'—á–∞—Å—Ç–Ω–∞—è', lat:51.1260, lng:71.4000 },
    { id: 4, t:'–ü—Ä–µ–∑–∏–¥–µ–Ω—Ç—Å–∫–∞—è –∫–ª–∏–Ω–∏–∫–∞', addr:'–ø—Ä. –ú–∞–Ω–≥–∏–ª–∏–∫ –ï–ª', tag:'—á–∞—Å—Ç–Ω–∞—è', lat:51.0954, lng:71.4218 }
  ];

  function getClinics(){
    const saved = localStorage.getItem('qt_clinics');
    if(saved){
      try{ return JSON.parse(saved); }catch(e){}
    }
    return BASE_CLINICS;
  }
  function setClinics(arr){
    localStorage.setItem('qt_clinics', JSON.stringify(arr));
  }

  /* ---------- –ö–∞—Ä—Ç–∞ ---------- */
  let map, markersLayer;
  function initMapIfNeeded(){
    if(map) return;
    const astana = [51.169392, 71.449074];
    map = L.map('map').setView(astana, 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap'
    }).addTo(map);
    markersLayer = L.layerGroup().addTo(map);
    refreshMarkers();
  }

  function refreshMarkers(filter = {}){
    if(!markersLayer) return;
    markersLayer.clearLayers();
    const list = filterClinics(filter);
    list.forEach(c=>{
      const m = L.marker([c.lat, c.lng]).addTo(markersLayer);
      const gmaps = `https://www.google.com/maps?q=${c.lat},${c.lng}`;
      m.bindPopup(`
        <div style="min-width:220px">
          <div style="font-weight:700;margin-bottom:6px">${escapeHTML(c.t)}</div>
          <div style="color:#6a7280;margin-bottom:8px">${escapeHTML(c.addr)}</div>
          <div style="display:flex; gap:8px; flex-wrap:wrap">
            <a href="${gmaps}" target="_blank" rel="noopener" class="leaflet-popup-close-button" style="text-decoration:none;color:#ff4fa3">üß≠ –ú–∞—Ä—à—Ä—É—Ç</a>
            <span class="pill">${escapeHTML(c.tag)}</span>
          </div>
        </div>
      `);
    });
    // –µ—Å–ª–∏ –µ—Å—Ç—å —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å ‚Äî —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –≤–æ–∫—Ä—É–≥ –ø–µ—Ä–≤–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π
    if(list.length>0){
      const b = L.latLngBounds(list.map(c=>[c.lat, c.lng]));
      map.fitBounds(b.pad(0.2));
    }
  }

  function filterClinics({q='', tag=''}){
    const text = q.trim().toLowerCase();
    const arr = getClinics();
    return arr.filter(c=>{
      const okTag = !tag || c.tag===tag;
      const okText = !text || (c.t.toLowerCase().includes(text) || c.addr.toLowerCase().includes(text));
      return okTag && okText;
    });
  }

  /* ---------- –°–ø–∏—Å–æ–∫ –∫–ª–∏–Ω–∏–∫ —Å–ø—Ä–∞–≤–∞ ---------- */
  function renderClinicsList(filter = {}){
    const box = document.getElementById('clinics-list');
    if(!box) return;
    const list = filterClinics(filter);
    box.innerHTML = '';
    if(list.length===0){
      box.innerHTML = `<div class="muted">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã.</div>`;
    }
    list.forEach(c=>{
      const el = document.createElement('div');
      el.className='item';
      const gmaps = `https://www.google.com/maps?q=${c.lat},${c.lng}`;
      el.innerHTML = `
        <div class="row" style="justify-content:space-between">
          <div>
            <div class="t">üè• ${escapeHTML(c.t)}</div>
            <div class="s">${escapeHTML(c.addr)}</div>
          </div>
          <div class="tag">${escapeHTML(c.tag)}</div>
        </div>
        <div class="row" style="margin-top:8px">
          <a class="btn" target="_blank" rel="noopener" href="${gmaps}">üß≠ –ú–∞—Ä—à—Ä—É—Ç</a>
          <button class="btn" data-focus="${c.id}">–ü–æ–∫–∞–∑–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
          <button class="btn warn" data-edit="${c.id}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
          <button class="btn danger" data-del="${c.id}">–£–¥–∞–ª–∏—Ç—å</button>
        </div>
      `;
      box.appendChild(el);
    });

    box.querySelectorAll('button[data-focus]').forEach(b=>{
      b.addEventListener('click', ()=>{
        const id = +b.getAttribute('data-focus');
        const c = getClinics().find(x=>x.id===id);
        location.hash = '#/clinics';
        show('clinics');
        initMapIfNeeded();
        if(c){
          map.setView([c.lat, c.lng], 15);
          // –∑–∞–ø—É—Å–∫–∞–µ–º —Ä–µ—Ñ—Ä–µ—à —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –±—ã–ª –º–∞—Ä–∫–µ—Ä
          refreshMarkers({q:document.getElementById('q').value, tag:document.getElementById('filter-tag').value});
        }
      });
    });

    box.querySelectorAll('button[data-del]').forEach(b=>{
      b.addEventListener('click', ()=>{
        const id = +b.getAttribute('data-del');
        const arr = getClinics().filter(x=>x.id!==id);
        setClinics(arr);
        renderClinicsList({q:document.getElementById('q').value, tag:document.getElementById('filter-tag').value});
        refreshMarkers({q:document.getElementById('q').value, tag:document.getElementById('filter-tag').value});
      });
    });

    box.querySelectorAll('button[data-edit]').forEach(b=>{
      b.addEventListener('click', ()=>{
        const id = +b.getAttribute('data-edit');
        const c = getClinics().find(x=>x.id===id);
        if(!c) return;
        openClinicEditor(c);
      });
    });
  }

  function openClinicEditor(existing=null){
    const t = existing ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–Ω–∏–∫—É' : '–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–Ω–∏–∫—É';
    const def = Object.assign({t:'',addr:'',tag:'–≥–æ—Å',lat:51.1694,lng:71.4491}, existing||{});
    const html = `
      <div style="display:grid; gap:10px">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ<input id="dlg-t" type="text" value="${escapeAttr(def.t)}"/></label>
        <label>–ê–¥—Ä–µ—Å<input id="dlg-addr" type="text" value="${escapeAttr(def.addr)}"/></label>
        <label>–¢–∏–ø<select id="dlg-tag">
          <option value="–≥–æ—Å" ${def.tag==='–≥–æ—Å'?'selected':''}>–≥–æ—Å</option>
          <option value="—á–∞—Å—Ç–Ω–∞—è" ${def.tag==='—á–∞—Å—Ç–Ω–∞—è'?'selected':''}>—á–∞—Å—Ç–Ω–∞—è</option>
        </select></label>
        <label>–®–∏—Ä–æ—Ç–∞ (lat)<input id="dlg-lat" type="number" step="0.000001" value="${def.lat}"/></label>
        <label>–î–æ–ª–≥–æ—Ç–∞ (lng)<input id="dlg-lng" type="number" step="0.000001" value="${def.lng}"/></label>
      </div>
    `;
    const wrapper = document.createElement('div');
    wrapper.className='card';
    wrapper.style.position='fixed';
    wrapper.style.left='50%';
    wrapper.style.top='50%';
    wrapper.style.transform='translate(-50%,-50%)';
    wrapper.style.zIndex='1000';
    wrapper.style.maxWidth='520px';
    wrapper.innerHTML = `
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
        <h3 style="margin:0">${t}</h3>
        <button class="btn danger" id="dlg-close">‚úï</button>
      </div>
      ${html}
      <div class="row" style="margin-top:12px; justify-content:flex-end">
        <button class="btn" id="dlg-cancel">–û—Ç–º–µ–Ω–∞</button>
        <button class="btn safe" id="dlg-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>
    `;
    document.body.appendChild(wrapper);

    function close(){ document.body.removeChild(wrapper); }

    wrapper.querySelector('#dlg-close').addEventListener('click', close);
    wrapper.querySelector('#dlg-cancel').addEventListener('click', close);
    wrapper.querySelector('#dlg-save').addEventListener('click', ()=>{
      const obj = {
        id: existing?.id ?? Date.now(),
        t: wrapper.querySelector('#dlg-t').value.trim(),
        addr: wrapper.querySelector('#dlg-addr').value.trim(),
        tag: wrapper.querySelector('#dlg-tag').value,
        lat: +wrapper.querySelector('#dlg-lat').value,
        lng: +wrapper.querySelector('#dlg-lng').value
      };
      if(!obj.t || !obj.addr || isNaN(obj.lat) || isNaN(obj.lng)){
        alert('–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ, –∞–¥—Ä–µ—Å –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.');
        return;
      }
      const arr = getClinics();
      const i = arr.findIndex(x=>x.id===obj.id);
      if(i>=0) arr[i]=obj; else arr.push(obj);
      setClinics(arr);
      renderClinicsList({q:document.getElementById('q').value, tag:document.getElementById('filter-tag').value});
      refreshMarkers({q:document.getElementById('q').value, tag:document.getElementById('filter-tag').value});
      close();
    });
  }

  /* ---------- –°—Ç–∞—Ç—å–∏ ---------- */
  const ARTICLES = [
    { t:'WHO ‚Äî Breast cancer (EN)', url:'https://www.who.int/news-room/fact-sheets/detail/breast-cancer' },
    { t:'NHS ‚Äî Breast cancer overview (EN)', url:'https://www.nhs.uk/conditions/breast-cancer/' },
    { t:'ACS ‚Äî Screening & Early Detection (EN)', url:'https://www.cancer.org/healthy/find-cancer-early/breast-cancer-screening.html' }
  ];
  function renderArticles(){
    const box = document.getElementById('articles-list');
    if(!box) return;
    box.innerHTML='';
    ARTICLES.forEach(a=>{
      const el = document.createElement('a');
      el.className='item';
      el.href=a.url; el.target='_blank'; el.rel='noopener';
      el.innerHTML = `<div class="t">üìö ${escapeHTML(a.t)}</div><div class="s">${escapeHTML(a.url)}</div>`;
      box.appendChild(el);
    });
  }

  /* ---------- –ü–æ–∏—Å–∫/—Ñ–∏–ª—å—Ç—Ä ---------- */
  function attachHandlers(){
    document.getElementById('btn-find').addEventListener('click', ()=>{
      const q = document.getElementById('q').value;
      const tag = document.getElementById('filter-tag').value;
      renderClinicsList({q, tag});
      initMapIfNeeded();
      refreshMarkers({q, tag});
    });
    document.getElementById('btn-reset').addEventListener('click', ()=>{
      document.getElementById('q').value='';
      document.getElementById('filter-tag').value='';
      renderClinicsList();
      initMapIfNeeded();
      refreshMarkers();
    });
    document.getElementById('btn-add').addEventListener('click', ()=>openClinicEditor());
  }

  /* ---------- –£—Ç–∏–ª–∏—Ç—ã ---------- */
  function escapeHTML(str){
    return String(str).replace(/[&<>"']/g, s => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[s]));
  }
  function escapeAttr(str){
    return escapeHTML(String(str)).replace(/"/g,'&quot;');
  }
})();
</script>
</body>
</html>
